<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="estimate">
    <select id="selectEstimateNextSequence" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        SELECT NEXTVAL(SEQ_ESTIMATE) AS EST_SEQ FROM DUAL
    </select>

    <select id="selectEstimateMasterList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        SELECT
            A.EST_SEQ, A.EST_VER, A.EST_NUM, A.EST_TITLE, A.EST_STATUS, SF_GET_CODE_NM(1045, A.EST_STATUS, 'EN') AS EST_STATUS_NM,
            A.ORDER_COMP_CD, SF_GET_COMP_NM(A.ORDER_COMP_CD) AS ORDER_COMP_NM,
            A.COMP_CD, SF_GET_COMP_NM(A.COMP_CD) AS COMP_NM,
            A.ORDER_STAFF_SEQ,SF_GET_STAFF_NM(A.ORDER_STAFF_SEQ) AS ORDER_STAFF_NM,
            A.EMAIL_TITLE, A.EMAIL_CONTENT, A.ETC_GFILE_SEQ, A.DEL_YN, A.INSERT_ID, A.UPDATE_DT, A.UPDATE_ID,
            COUNT(B.SEQ) AS DTL_CNT, A.EST_USER_ID,
            SUM(CASE WHEN B.UNIT_FINAL_EST_AMT IS NOT NULL THEN IFNULL(B.UNIT_FINAL_EST_AMT, 0) * IFNULL(B.ITEM_QTY, 0)
                ELSE ((IFNULL(B.UNIT_MATERIAL_AMT, 0) + IFNULL(B.UNIT_TM_AMT, 0) + IFNULL(B.UNIT_GRIND_AMT, 0) + IFNULL(B.UNIT_HEAT_AMT, 0) +
                        IFNULL(B.UNIT_SURFACE_AMT, 0) + IFNULL(B.UNIT_PROCESS_AMT, 0) + IFNULL(B.UNIT_ETC_AMT, 0)) * IFNULL(B.ITEM_QTY, 0))
            END) AS DTL_AMOUNT,
            SF_GET_DATE_F(A.INSERT_DT,'YYYY','') AS INSERT_DT, SF_GET_DATE_F(A.SEND_DT,'YYYY','') AS SEND_DT
        FROM TBL_ESTIMATE A
            LEFT OUTER JOIN TBL_ESTIMATE_DETAIL B ON A.EST_SEQ = B.EST_SEQ
        WHERE 1=1
            <if test="EST_SEQ !='' and EST_SEQ !=null">
                AND A.EST_SEQ = #{EST_SEQ}
            </if>
        GROUP BY A.EST_SEQ
        ORDER BY A.EST_NUM, A.EST_SEQ, A.EST_VER
    </select>

    <select id="selectEstimateDetailList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        SELECT
            EST_SEQ, SEQ, PROJECT_NM, MODULE_NM, ITEM_NM, DRAWING_NUM, PART_NUM, IFNULL(MATERIAL_SUPPLY_YN, SPACE(0)) AS MATERIAL_SUPPLY_YN,
            IFNULL(ITEM_QTY, SPACE(0)) AS ITEM_QTY, IFNULL(SIZE_TXT, SPACE(0)) AS SIZE_TXT, IFNULL(SIZE_TYPE, SPACE(0)) AS SIZE_TYPE,
            SIZE_W, SIZE_H, SIZE_T, SIZE_D, SIZE_L,
            SIZE_W_M, SIZE_H_M, SIZE_T_M, SIZE_D_M, SIZE_L_M,
            IFNULL(WORK_TYPE, SPACE(0)) AS WORK_TYPE, SF_GET_CODE_NM(1033, WORK_TYPE, 'EN') AS WORK_TYPE_NM,
            IFNULL(MATERIAL_TYPE, SPACE(0)) AS MATERIAL_TYPE, SF_GET_CODE_NM(1035, MATERIAL_TYPE, 'EN') AS MATERIAL_TYPE_NM,
            IFNULL(MATERIAL_DETAIL, SPACE(0)) AS MATERIAL_DETAIL, SF_GET_CODE_NM(1027, MATERIAL_DETAIL, 'EN') AS MATERIAL_DETAIL_NM,
            IFNULL(MATERIAL_KIND, SPACE(0)) AS MATERIAL_KIND, SF_GET_CODE_NM(1029, MATERIAL_KIND, 'EN') AS MATERIAL_KIND_NM,
            IFNULL(SURFACE_TREAT, SPACE(0)) AS SURFACE_TREAT, SF_GET_CODE_NM(1039, SURFACE_TREAT, 'EN') AS SURFACE_TREAT_NM,
            IFNULL(MATERIAL_NOTE, SPACE(0)) AS MATERIAL_NOTE,
            IFNULL(DETAIL_LATHE, SPACE(0)) AS DETAIL_LATHE, IFNULL(DETAIL_SURFACE, SPACE(0)) AS DETAIL_SURFACE, IFNULL(DETAIL_CLAMPING, SPACE(0)) AS DETAIL_CLAMPING,
            IFNULL(DETAIL_POCKET, SPACE(0)) AS DETAIL_POCKET, IFNULL(DETAIL_DRILL, SPACE(0)) AS DETAIL_DRILL, IFNULL(DETAIL_DIFFICULTY, SPACE(0)) AS DETAIL_DIFFICULTY,
            IFNULL(MATERIAL_FINISH_TM, SPACE(0)) AS MATERIAL_FINISH_TM, IFNULL(MATERIAL_FINISH_GRIND, SPACE(0)) AS MATERIAL_FINISH_GRIND, IFNULL(MATERIAL_FINISH_HEAT, SPACE(0)) AS MATERIAL_FINISH_HEAT,
            IFNULL(UNIT_MATERIAL_AMT, SPACE(0)) AS UNIT_MATERIAL_AMT, IFNULL(UNIT_TM_AMT, SPACE(0)) AS UNIT_TM_AMT,
            IFNULL(UNIT_GRIND_AMT, SPACE(0)) AS UNIT_GRIND_AMT, IFNULL(UNIT_HEAT_AMT, SPACE(0)) AS UNIT_HEAT_AMT,
            IFNULL(UNIT_SURFACE_AMT, SPACE(0)) AS UNIT_SURFACE_AMT, IFNULL(UNIT_PROCESS_AMT, SPACE(0)) AS UNIT_PROCESS_AMT,
            IFNULL(UNIT_ETC_AMT, SPACE(0)) AS UNIT_ETC_AMT,
            UNIT_MATERIAL_AUTO_YN, UNIT_TM_AUTO_YN, UNIT_GRIND_AUTO_YN, UNIT_HEAT_AUTO_YN,
            UNIT_SURFACE_AUTO_YN, UNIT_PROCESS_AUTO_YN,
            IFNULL(UNIT_AMT_NOTE, SPACE(0)) AS UNIT_AMT_NOTE, UNIT_FINAL_EST_AMT,
            IFNULL(NOTE, SPACE(0)) AS NOTE, DWG_GFILE_SEQ, DXF_GFILE_SEQ, PDF_GFILE_SEQ, IMG_GFILE_SEQ,
            CASE WHEN UNIT_FINAL_EST_AMT IS NOT NULL THEN IFNULL(UNIT_FINAL_EST_AMT, 0) * IFNULL(ITEM_QTY, 0)
                ELSE (IFNULL(UNIT_MATERIAL_AMT, 0) + IFNULL(UNIT_TM_AMT, 0) + IFNULL(UNIT_GRIND_AMT, 0) + IFNULL(UNIT_HEAT_AMT, 0) +
                        IFNULL(UNIT_SURFACE_AMT, 0) + IFNULL(UNIT_PROCESS_AMT, 0) + IFNULL(UNIT_ETC_AMT, 0)) * IFNULL(ITEM_QTY, 0)
            END AS DTL_AMOUNT
        FROM TBL_ESTIMATE_DETAIL
         WHERE 1=1
			AND EST_SEQ = #{EST_SEQ}
    </select>

    <select id="selectEstimateMasterListPop" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        SELECT
            A.EST_SEQ, A.EST_NUM, A.EST_VER, A.EST_TITLE,
            A.EST_STATUS, SF_GET_CODE_NM(1048, A.EST_STATUS, 'EN') AS EST_STATUS_NM,
            A.ORDER_COMP_CD, C.COMP_NM AS ORDER_COMP_NM,
            A.ORDER_STAFF_SEQ, E.STAFF_NM AS ORDER_STAFF_NM, A.COMP_CD, D.COMP_NM AS COMP_NM,
            COUNT(B.SEQ) AS DTL_CNT, SUM(B.UNIT_FINAL_EST_AMT) AS DTL_AMOUNT,
            DATE_FORMAT(A.INSERT_DT, '%Y-%m-%d %T') INSERT_DT, A.EST_USER_ID, A.SEND_DT
        FROM TBL_ESTIMATE A
            LEFT OUTER JOIN TBL_ESTIMATE_DETAIL B ON A.EST_SEQ = B.EST_SEQ
            LEFT OUTER JOIN TBL_COMPANY C ON A.ORDER_COMP_CD = C.COMP_CD
            LEFT OUTER JOIN TBL_COMPANY D ON A.COMP_CD = D.COMP_CD
            LEFT OUTER JOIN TBL_COMPANY_STAFF E ON A.ORDER_STAFF_SEQ = E.STAFF_SEQ AND E.DEL_YN = 'N'
        WHERE A.EST_SEQ = #{EST_SEQ}
        GROUP BY A.EST_SEQ
        ORDER BY A.EST_SEQ, A.EST_NUM
    </select>

    <insert id="insertEstimateMaster" parameterType="java.util.HashMap">
        INSERT INTO TBL_ESTIMATE
            (EST_SEQ, EST_VER, EST_NUM, ORDER_COMP_CD, ORDER_STAFF_SEQ, COMP_CD, EST_USER_ID,
            EST_TITLE, EST_STATUS, DEL_YN, INSERT_DT, INSERT_ID)
        SELECT
            #{EST_SEQ} AS EST_SEQ, EST_VER, EST_NUM,
            #{ORDER_COMP_CD} AS ORDER_COMP_CD, #{ORDER_STAFF_SEQ} AS ORDER_STAFF_SEQ, #{COMP_CD} AS COMP_CD, #{EST_USER_ID} AS EST_USER_ID,
            #{EST_TITLE} AS EST_TITLE, 'EST010' AS EST_STATUS, 'N' AS DEL_YN, NOW() AS INSERT_DT, NULL AS INSERT_ID
        FROM (
            SELECT
                0 AS EST_VER,
                CONCAT('EST-', DATE_FORMAT(NOW(), '%Y%m%d'), LPAD(CAST(COUNT(*)+1 AS CHAR), 3, '0')) EST_NUM
            FROM TBL_ESTIMATE
            WHERE DATE_FORMAT(INSERT_DT, '%Y%m%d') = DATE_FORMAT(NOW(), '%Y%m%d')
        ) Z
        ON DUPLICATE KEY UPDATE
            ORDER_COMP_CD = #{ORDER_COMP_CD},
            ORDER_STAFF_SEQ = #{ORDER_STAFF_SEQ},
            COMP_CD = #{COMP_CD},
            EST_USER_ID = #{EST_USER_ID},
            EST_TITLE = #{EST_TITLE},
            UPDATE_DT = NOW(),
            UPDATE_ID = NULL
    </insert>

    <insert id="insertEstimateDetail" parameterType="java.util.HashMap">
        INSERT INTO TBL_ESTIMATE_DETAIL
        (
            EST_SEQ, SEQ, PROJECT_NM, MODULE_NM, ITEM_NM, DRAWING_NUM, PART_NUM, MATERIAL_SUPPLY_YN,
            ITEM_QTY, SIZE_TXT, SIZE_TYPE,
            SIZE_W, SIZE_H, SIZE_T, SIZE_D, SIZE_L,
            SIZE_W_M, SIZE_H_M, SIZE_T_M, SIZE_D_M, SIZE_L_M,
            WORK_TYPE, MATERIAL_TYPE, MATERIAL_DETAIL, MATERIAL_KIND, SURFACE_TREAT, MATERIAL_NOTE,
            DETAIL_LATHE, DETAIL_SURFACE, DETAIL_CLAMPING, DETAIL_POCKET, DETAIL_DRILL, DETAIL_DIFFICULTY,
            MATERIAL_FINISH_TM, MATERIAL_FINISH_GRIND, MATERIAL_FINISH_HEAT,
            UNIT_MATERIAL_AMT, UNIT_TM_AMT, UNIT_GRIND_AMT, UNIT_HEAT_AMT, UNIT_SURFACE_AMT, UNIT_PROCESS_AMT, UNIT_ETC_AMT,
            UNIT_MATERIAL_AUTO_YN, UNIT_TM_AUTO_YN, UNIT_GRIND_AUTO_YN, UNIT_HEAT_AUTO_YN,
            UNIT_SURFACE_AUTO_YN, UNIT_PROCESS_AUTO_YN,
            UNIT_AMT_NOTE, UNIT_FINAL_EST_AMT,
            NOTE, DWG_GFILE_SEQ, DXF_GFILE_SEQ, PDF_GFILE_SEQ, IMG_GFILE_SEQ,
            INSERT_ID
        )
        VALUES
        (
            #{EST_SEQ}, NEXTVAL(SEQ_ESTIMATE_DETAIL), #{PROJECT_NM}, #{MODULE_NM}, #{ITEM_NM}, #{DRAWING_NUM}, #{PART_NUM}, #{MATERIAL_SUPPLY_YN},
            #{ITEM_QTY}, #{SIZE_TXT},
            SF_GET_SIZE_TXT('SIZE_TYPE', #{SIZE_TXT}), SF_GET_SIZE_TXT('SIZE_W', #{SIZE_TXT}),
            SF_GET_SIZE_TXT('SIZE_H', #{SIZE_TXT}), SF_GET_SIZE_TXT('SIZE_T', #{SIZE_TXT}),
            SF_GET_SIZE_TXT('SIZE_D', #{SIZE_TXT}), SF_GET_SIZE_TXT('SIZE_L', #{SIZE_TXT}),
            #{SIZE_W_M}, #{SIZE_H_M}, #{SIZE_T_M}, #{SIZE_D_M}, #{SIZE_L_M},
            #{WORK_TYPE}, #{MATERIAL_TYPE}, #{MATERIAL_DETAIL}, #{MATERIAL_KIND}, #{SURFACE_TREAT}, #{MATERIAL_NOTE},
            #{DETAIL_LATHE}, #{DETAIL_SURFACE}, #{DETAIL_CLAMPING}, #{DETAIL_POCKET}, #{DETAIL_DRILL}, #{DETAIL_DIFFICULTY},
            #{MATERIAL_FINISH_TM}, #{MATERIAL_FINISH_GRIND}, #{MATERIAL_FINISH_HEAT},
            #{UNIT_MATERIAL_AMT}, #{UNIT_TM_AMT}, #{UNIT_GRIND_AMT}, #{UNIT_HEAT_AMT}, #{UNIT_SURFACE_AMT}, #{UNIT_PROCESS_AMT}, #{UNIT_ETC_AMT},
            'N','N','N','N','N','N',
            #{UNIT_AMT_NOTE}, #{UNIT_FINAL_EST_AMT},
            #{NOTE}, #{DWG_GFILE_SEQ}, #{DXF_GFILE_SEQ}, #{PDF_GFILE_SEQ}, #{IMG_GFILE_SEQ},
            NULL
        )
    </insert>

    <insert id="insertEstimateReceiver" parameterType="java.util.HashMap">
        INSERT INTO TBL_ESTIMATE_RECEIVER(EST_SEQ, SEQ, RECEIVER_NM, RECEIVER_EMAIL, RECEIVER_TEL)
        VALUES(#{EST_SEQ}, NEXTVAL(SEQ_ESTIMATE_RECEIVER), #{STAFF_NM}, #{STAFF_EMAIL}, #{STAFF_TEL})
    </insert>

    <update id="updateEstimateMaster"  parameterType="java.util.HashMap">
        UPDATE TBL_ESTIMATE
        SET
            EST_NUM = #{EST_NUM},
            ORDER_COMP_CD = #{ORDER_COMP_CD},
            ORDER_STAFF_SEQ = #{ORDER_STAFF_SEQ},
            COMP_CD = #{COMP_CD},
            EST_USER_ID = #{EST_USER_ID},
            EST_TITLE = #{EST_TITLE},
            EST_STATUS = #{EST_STATUS},
            DEL_YN = #{DEL_YN},
            UPDATE_DT = NOW(),
            UPDATE_ID = NULL
        WHERE EST_SEQ = #{EST_SEQ}
            AND EST_VER = #{EST_VER}
    </update>

    <update id="updateEstimateDetail"  parameterType="java.util.HashMap">
        UPDATE TBL_ESTIMATE_DETAIL
        SET PROJECT_NM = #{PROJECT_NM},
            MODULE_NM = #{MODULE_NM},                       ITEM_NM = #{ITEM_NM},
            DRAWING_NUM = #{DRAWING_NUM},                   PART_NUM = #{PART_NUM},
            MATERIAL_SUPPLY_YN = #{MATERIAL_SUPPLY_YN},     SIZE_TXT = #{SIZE_TXT},
            SIZE_TYPE = SF_GET_SIZE_TXT('SIZE_TYPE', #{SIZE_TXT}),
            SIZE_W = SF_GET_SIZE_TXT('SIZE_W', #{SIZE_TXT}),
            SIZE_H = SF_GET_SIZE_TXT('SIZE_H', #{SIZE_TXT}),
            SIZE_T = SF_GET_SIZE_TXT('SIZE_T', #{SIZE_TXT}),
            SIZE_D = SF_GET_SIZE_TXT('SIZE_D', #{SIZE_TXT}),
            SIZE_L = SF_GET_SIZE_TXT('SIZE_L', #{SIZE_TXT}),
            SIZE_W_M = #{SIZE_W_M},                             SIZE_H_M = #{SIZE_H_M},
            SIZE_T_M = #{SIZE_T_M},                             SIZE_D_M = #{SIZE_D_M},
            SIZE_L_M = #{SIZE_L_M},                             ITEM_QTY = #{ITEM_QTY},
            WORK_TYPE = #{WORK_TYPE},                           MATERIAL_TYPE = #{MATERIAL_TYPE},
            MATERIAL_DETAIL = #{MATERIAL_DETAIL},               MATERIAL_KIND = #{MATERIAL_KIND},
            SURFACE_TREAT = #{SURFACE_TREAT},                   MATERIAL_NOTE = #{MATERIAL_NOTE},
            DETAIL_LATHE = #{DETAIL_LATHE},                     DETAIL_SURFACE = #{DETAIL_SURFACE},
            DETAIL_CLAMPING = #{DETAIL_CLAMPING},               DETAIL_POCKET = #{DETAIL_POCKET},
            DETAIL_DRILL = #{DETAIL_DRILL},                     DETAIL_DIFFICULTY = #{DETAIL_DIFFICULTY},
            MATERIAL_FINISH_TM = #{MATERIAL_FINISH_TM},         MATERIAL_FINISH_GRIND = #{MATERIAL_FINISH_GRIND},
            MATERIAL_FINISH_HEAT = #{MATERIAL_FINISH_HEAT},     UNIT_MATERIAL_AMT = #{UNIT_MATERIAL_AMT},
            UNIT_TM_AMT = #{UNIT_TM_AMT},                       UNIT_GRIND_AMT = #{UNIT_GRIND_AMT},
            UNIT_HEAT_AMT = #{UNIT_HEAT_AMT},                   UNIT_SURFACE_AMT = #{UNIT_SURFACE_AMT},
            UNIT_PROCESS_AMT = #{UNIT_PROCESS_AMT},             UNIT_ETC_AMT = #{UNIT_ETC_AMT},
            UNIT_MATERIAL_AUTO_YN = #{UNIT_MATERIAL_AUTO_YN},   UNIT_TM_AUTO_YN = #{UNIT_TM_AUTO_YN},
            UNIT_GRIND_AUTO_YN = #{UNIT_GRIND_AUTO_YN},         UNIT_HEAT_AUTO_YN = #{UNIT_HEAT_AUTO_YN},
            UNIT_SURFACE_AUTO_YN = #{UNIT_SURFACE_AUTO_YN},     UNIT_PROCESS_AUTO_YN = #{UNIT_PROCESS_AUTO_YN},
            UNIT_AMT_NOTE = #{UNIT_AMT_NOTE},                   UNIT_FINAL_EST_AMT = #{UNIT_FINAL_EST_AMT},
            NOTE = #{NOTE},
            DWG_GFILE_SEQ = #{DWG_GFILE_SEQ},                   DXF_GFILE_SEQ = #{DXF_GFILE_SEQ},
            PDF_GFILE_SEQ = #{PDF_GFILE_SEQ},                   IMG_GFILE_SEQ = #{IMG_GFILE_SEQ},
            UPDATE_DT = #{UPDATE_DT},                           UPDATE_ID = #{UPDATE_ID}
        WHERE EST_SEQ = #{EST_SEQ}

    </update>

    <delete id="deleteEstimateMaster"  parameterType="java.util.HashMap">
        DELETE FROM TBL_ESTIMATE
        WHERE EST_SEQ = #{EST_SEQ}
            AND EST_VER = #{EST_VER}
    </delete>

    <delete id="deleteEstimateDetail"  parameterType="java.util.HashMap">
        DELETE FROM TBL_ESTIMATE_DETAIL
        WHERE EST_SEQ = #{EST_SEQ}
    </delete>

    <insert id="insertEstimateMasterVersion"  parameterType="java.util.HashMap">
        INSERT INTO TBL_ESTIMATE
            (EST_SEQ, EST_VER, EST_NUM, ORDER_COMP_CD, ORDER_STAFF_SEQ, COMP_CD, EST_USER_ID,
            EST_TITLE, EST_STATUS, DEL_YN, INSERT_DT, INSERT_ID)
        SELECT
            #{N_EST_SEQ}, (SELECT MAX(EST_VER)+1 FROM TBL_ESTIMATE WHERE A.EST_NUM = EST_NUM) EST_VER,
            EST_NUM, ORDER_COMP_CD, ORDER_STAFF_SEQ, COMP_CD, EST_USER_ID,
            EST_TITLE, 'EST010', DEL_YN, NOW(), INSERT_ID
        FROM TBL_ESTIMATE A
        WHERE EST_SEQ = #{EST_SEQ}
    </insert>

    <insert id="insertEstimateDetailVersion"  parameterType="java.util.HashMap">
        INSERT INTO TBL_ESTIMATE_DETAIL
        (
            EST_SEQ, SEQ, PROJECT_NM, MODULE_NM, ITEM_NM, DRAWING_NUM, PART_NUM, MATERIAL_SUPPLY_YN,
            ITEM_QTY, SIZE_TXT, SIZE_TYPE, SIZE_W, SIZE_H, SIZE_T, SIZE_D, SIZE_L,
            SIZE_W_M, SIZE_H_M, SIZE_T_M, SIZE_D_M, SIZE_L_M,
            WORK_TYPE, MATERIAL_TYPE, MATERIAL_DETAIL, MATERIAL_KIND, SURFACE_TREAT, MATERIAL_NOTE,
            DETAIL_LATHE, DETAIL_SURFACE, DETAIL_CLAMPING, DETAIL_POCKET, DETAIL_DRILL, DETAIL_DIFFICULTY,
            MATERIAL_FINISH_TM, MATERIAL_FINISH_GRIND, MATERIAL_FINISH_HEAT,
            UNIT_MATERIAL_AMT, UNIT_TM_AMT, UNIT_GRIND_AMT, UNIT_HEAT_AMT, UNIT_SURFACE_AMT, UNIT_PROCESS_AMT, UNIT_ETC_AMT,
            UNIT_MATERIAL_AUTO_YN, UNIT_TM_AUTO_YN, UNIT_GRIND_AUTO_YN, UNIT_HEAT_AUTO_YN,
            UNIT_SURFACE_AUTO_YN, UNIT_PROCESS_AUTO_YN,
            UNIT_AMT_NOTE, UNIT_FINAL_EST_AMT,
            NOTE, DWG_GFILE_SEQ, DXF_GFILE_SEQ, PDF_GFILE_SEQ, IMG_GFILE_SEQ,
            INSERT_DT, INSERT_ID
        )
        SELECT
            #{N_EST_SEQ} AS EST_SEQ, NEXTVAL(SEQ_ESTIMATE_DETAIL) AS SEQ, PROJECT_NM, MODULE_NM, ITEM_NM, DRAWING_NUM, PART_NUM, MATERIAL_SUPPLY_YN,
            ITEM_QTY, SIZE_TXT, SIZE_TYPE, SIZE_W, SIZE_H, SIZE_T, SIZE_D, SIZE_L,
            SIZE_W_M, SIZE_H_M, SIZE_T_M, SIZE_D_M, SIZE_L_M,
            WORK_TYPE, MATERIAL_TYPE, MATERIAL_DETAIL, MATERIAL_KIND, SURFACE_TREAT, MATERIAL_NOTE,
            DETAIL_LATHE, DETAIL_SURFACE, DETAIL_CLAMPING, DETAIL_POCKET, DETAIL_DRILL, DETAIL_DIFFICULTY,
            MATERIAL_FINISH_TM, MATERIAL_FINISH_GRIND, MATERIAL_FINISH_HEAT,
            UNIT_MATERIAL_AMT, UNIT_TM_AMT, UNIT_GRIND_AMT, UNIT_HEAT_AMT, UNIT_SURFACE_AMT, UNIT_PROCESS_AMT, UNIT_ETC_AMT,
            UNIT_MATERIAL_AUTO_YN, UNIT_TM_AUTO_YN, UNIT_GRIND_AUTO_YN, UNIT_HEAT_AUTO_YN,
            UNIT_SURFACE_AUTO_YN, UNIT_PROCESS_AUTO_YN,
            UNIT_AMT_NOTE, UNIT_FINAL_EST_AMT,
            NOTE, DWG_GFILE_SEQ, DXF_GFILE_SEQ, PDF_GFILE_SEQ, IMG_GFILE_SEQ,
            INSERT_DT, INSERT_ID
        FROM TBL_ESTIMATE_DETAIL
         WHERE 1=1
			AND EST_SEQ = #{EST_SEQ}
    </insert>

</mapper>